{% extends "base.html" %}

{% block title %}Admin â€“ {{ package_id }} {{ version_meta.version }} | winget REST
Repository{% endblock %}

{% block content %}
<section>
  <h2>
    Version: <code>{{ package_id }}</code> {{ version_meta.version }}
  </h2>

  <form
    method="post"
    action="/admin/packages/{{ package_id }}/versions/{{ version_meta.version }}"
    class="form"
    enctype="multipart/form-data"
  >
    <div class="form-row">
      <label for="version">Version</label>
      <input
        id="version"
        name="version"
        type="text"
        value="{{ version_meta.version }}"
        disabled
      />
    </div>

    <div class="form-row">
      <label for="architecture">Architecture</label>
      <input
        id="architecture"
        name="architecture"
        type="text"
        value="{{ version_meta.architecture }}"
        required
      />
    </div>

    <div class="form-row">
      <label for="scope">Scope</label>
      <input
        id="scope"
        name="scope"
        type="text"
        value="{{ version_meta.scope }}"
        required
      />
    </div>

    <div class="form-row">
      <label for="installer_type">Installer type</label>
      <input
        id="installer_type"
        name="installer_type"
        type="text"
        value="{{ version_meta.installer_type }}"
      />
    </div>

    <div class="form-row">
      <label for="installer_file">Installer file name</label>
      <input
        id="installer_file"
        type="text"
        value="{{ version_meta.installer_file or '' }}"
        readonly
      />
      <p class="hint">
        The file lives next to <code>version.json</code> in the version
        directory. To change it, upload a new installer below.
      </p>
    </div>

    <div class="form-row">
      <label for="upload">Upload new installer (optional)</label>
      <input id="upload" name="upload" type="file" />
      <p class="hint">
        If you choose a file here, it will be saved in the version directory and
        the installer file name above will be updated to match.
      </p>
    </div>

    <div class="form-row">
      <label for="silent_arguments">Silent arguments</label>
      <input
        id="silent_arguments"
        name="silent_arguments"
        type="text"
        value="{{ version_meta.silent_arguments or '' }}"
      />
    </div>

    <div class="form-row">
      <label for="interactive_arguments">Interactive arguments</label>
      <input
        id="interactive_arguments"
        name="interactive_arguments"
        type="text"
        value="{{ version_meta.interactive_arguments or '' }}"
      />
    </div>

    <div class="form-row">
      <label for="log_arguments">Log arguments</label>
      <input
        id="log_arguments"
        name="log_arguments"
        type="text"
        value="{{ version_meta.log_arguments or '' }}"
      />
    </div>

    <div class="form-actions">
      <button type="submit">Save version</button>
      <a href="/admin/packages/{{ package_id }}" class="button-secondary"
        >Back to package</a
      >
    </div>
  </form>
</section>

<section>
  <h3>Danger zone</h3>
  <form
    method="post"
    action="/admin/packages/{{ package_id }}/versions/{{ version_meta.version }}/delete"
    onsubmit="return confirm('Delete this version and its files from disk?');"
  >
    <button type="submit" class="button-danger">Delete this version</button>
  </form>
</section>
{% endblock %}


